<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <title>Tic Tac Toe</title>
  <style>
  body {
    text-align: center;
    font-family: arial, sans-serif;
  }

  #panel {
     margin: 50px auto;
     border-collapse: collapse;
  }

  td {
    border-width: 2px;
    border-style: solid;
    border-color: #999;
    width: 120px;
    height: 120px;
    font-size: 100px;
    cursor: pointer;
    text-shadow: 3px 3px 2px #aaa;
  }

  tr:nth-of-type(odd) td:nth-of-type(odd) {
    background-color: #c9c9c9;
  }

  tr:nth-of-type(even) td:nth-of-type(even) {
    background-color: #c9c9c9;
  }

   td:hover {
    background-color: #e8e8e8 !important;
  }

  .chosen {
    /*color: red;*/
  }
  </style>
</head>
<body>
  <table id="panel"></table>

  <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
  <script src="http://private.myvagrant/procedures.js"></script>
  <script>
  $(function(){
    'use strict';
    var size = 5;
    var grid = new Array(size);
    var count = 0;
    var yourTurn = true;

    for (i = 0; i < size; i++){

      grid[i] = new Array(size);

    }

    for (var i = 0; i < size; i++){

      $('#panel').append('<tr id=row' + i +'></tr>');

        for (var j = 0; j < size; j++){

          $('#row' + i).append('<td id=column' + j +'>  </td>');
        }
      }

      $('td').click(function(){

        if (!yourTurn){

          alert('It\'s not your turn!');
          return;

        }

        if ($(this).hasClass('chosen')){
          alert('Invalid move!');

        } else {

          $(this).addClass('chosen').text('○').css('color','red');
          var row1 = parseInt($(this).parent().attr('id').charAt(3));
          var column1 = parseInt($(this).attr('id').charAt(6));
          grid[row1][column1] = 0;
          count ++;
          yourTurn = false

          if (!gameOn(grid, row1, column1, 0)){

            alert('You win!');
            location.href = "";

          } else if (count < size * size){

            setTimeout(function(){

              var om = opponentMove(grid);
              var row2 = om[0];
              var column2 = om[1];
              grid[row2][column2] = 1;
              count++;
              $('#row' + row2 + ' #column' + column2).addClass('chosen').text('×').css('color','blue');
              yourTurn = true;

              if (!gameOn(grid, row2, column2, 1)){
                alert('You lose!');
                location.href = "";
              }

            }, 500);

          } else {

            alert('Game over!');

          }
        }
      });
    });
  </script>
</body>
</html>